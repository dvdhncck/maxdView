<HTML>
<HEAD>
<TITLE>Profile Filter</TITLE>
</HEAD>
<BODY>
<!-- PAGE BREAK -->

<H2>Profile Filter</H2>

<UL>
<LI><A HREF="#overview">Overview</A>
<LI><A HREF="#interface">User interface</A>
<LI><A HREF="#commands">Plugin Commands</A>
</UL>

<HR>

<A NAME="overview"><H3>Overview</H3></A>

<P>The <I>Profile Filter</I> selects spots that have a similar
expression profile to some `target' Spot.</P>

<P>An expression profile is the sequence of changes between expression
levels of a spot across a series of Measurements. In a time series for
example, the profile might be that the expression level rose between
't=0' and 't=1' and then fell from 't=1' to 't=2' and rose from 't=2' to
't=3'. </P>

<P>The <I>Profile Filter</I> finds the spots with the most similar
profile to the selected `target' Spot. Two comparisons metrics are
provided: 'Distance' and 'Direction and Distance'.</P>

<P>As with all filter plugins, closing the plugin's window deactives
the filter (but iconifying it does not).</P>

<HR>

<A NAME="interface"><H3>User Interface</H3></A>

<P>On the left of the panel is a list of all Measurements in the
current data. You can select two or more of the Measurements for
inclusion in the profile.</P>

<P><TABLE WIDTH=80%><TR><TD>
<I>Note: </I> Selecting more than one item in the list is done
using the "SHIFT" and "CTRL" keys in conjunction with mouse
clicks. "SHIFT-click" selects everything between the click point and
the previous click, and "CTRL-click" toggles the clicked item.
</TD></TR></TABLE></P>

<P>On the right of the panel is a list of all Spots, select one of
these to act as the `target' Spot. You can use <A
HREF="../../../docs/Concepts.html#drag">drag-and-drop</a> to transfer
a Spot from another window.</P>

<P>Below the two lists is a text field for selecting how many of the
nearest profiles to allow through the filter and a dropdown list for
adjusting the similarity metric.</P>

<P>The similarity metric is the calculation that is used to quantify
the similarity between two profiles. Three different metrics are
supported in this plugin:</P>

<P><TABLE WIDTH=90%> 
<TR><TD ALIGN=RIGHT>Distance:&nbsp;</TD><TD><I>the sum of the squared differences between values</I></TD></TR>
<TR><TD ALIGN=RIGHT>Slope:&nbsp;</TD><TD><I>the sum of the differences between the first derivatives of the values</I></TD></TR>
<TR><TD ALIGN=RIGHT>Direction:&nbsp;</TD><TD><I>a score generated by comparing direction changes</I></TD></TR>
</TABLE></P>

<P>The three metrics are illustrated in the following example in which
there are 4 spots (A,B,C and D) with values in 3 Measurements (1,2 and
3):</P>

<CENTER>
<TABLE>
<TR>
<TD ALIGN=RIGHT VALIGN=MIDDLE>
<TABLE BORDER=1>
<TR>
<TD></TD><TD ALIGN=CENTER><B>Meas 1</B></TD><TD ALIGN=CENTER><B>Meas 2</B></TD><TD ALIGN=CENTER><B>Meas 3</B></TD></TR>
<TD><FONT COLOR="#3333ff"><B>Spot A</B></FONT></TD><TD ALIGN=RIGHT>0.75</TD><TD ALIGN=RIGHT>0.0</TD><TD ALIGN=RIGHT>0.1</TD></TR>
<TD><FONT COLOR="#ff0033"><B>Spot B</B></FONT></TD><TD ALIGN=RIGHT>0.65</TD><TD ALIGN=RIGHT>0.1</TD><TD ALIGN=RIGHT>-0.05</TD></TR>
<TD><FONT COLOR="#66ff99"><B>Spot C</B></FONT></TD><TD ALIGN=RIGHT>0.05</TD><TD ALIGN=RIGHT>-0.6</TD><TD ALIGN=RIGHT>-0.7</TD></TR>
<TD><FONT COLOR="#ff9933"><B>Spot D</B></FONT></TD><TD ALIGN=RIGHT>-0.1</TD><TD ALIGN=RIGHT>-0.8</TD><TD ALIGN=RIGHT>-0.4</TD></TR>
</TABLE></TD>
<TD ALIGN=LEFT><IMG SRC="Profiles.jpg"></CENTER></TD>
</TR>
</TABLE>
</CENTER>

<P>Using the <B>Distance</B> metric, spots A and B are most
similar. This is because the sum of of the absolute differences
between corresponding pairs of values is smallest for these two
profiles.</P>

<P>Formally: 

<PRE>
    distance_metric(A, B) = abs(A1 - B1) + abs(A2 - B2) + abs(A3 - B3)
    distance_metric(A, C) = abs(A1 - C1) + abs(A2 - C2) + abs(A3 - C3)
    .....
</PRE>

where <TT>abs()</TT> is the <I>absolute</I> function: <TT>abs(-X) = X</TT></P>

<P>With the <B>Slope</B> metric, spots A and C are most similar. This
metric calculates the sum of the differences of the first derivatives
of the values, i.e. the slopes of the two line segments (the one
joining Measurements 1 and 2 and the other one joining Measurements 2
and 3). The profile with the smallest sum is regarded as the most
similar.</P>

<P>Formally: 

<PRE>
    slope_metric(A, B) = abs( (A2-A1) - (B2-B1) ) + abs( (A3-A2) - (B3-B3) )
    slope_metric(A, C) = abs( (A2-A1) - (C2-C1) ) + abs( (A3-A2) - (C3-C3) )
    .....
</PRE>

<P>This metric therefore chooses lines which have similar (but not
neccessarily identical) behaviours in terms of the changes between
Measurements</P>


<P>The final metric, <B>Direction</B> compares only the direction of
the slopes of the lines joining the Measurements. A 'score' is
generated by comparing each pair of line segments, if they go in
different directions then 1 is added to the score. The most similar
profile is the ones with the lowest score. In the above example, spots
A and D are the most similar because they both go "down, up" (spots C
and B both go "down,down").</P>


<HR>

<A NAME="commands"><H3>Plugin Commands</H3></A>

<P><UL>
<P><LI><B><TT>start</TT></B><TABLE><TR><TD VALIGN=TOP><I>Arguments </I></TD><TD>
<P><B><TT>select
</TT></B><TABLE><TR><TD VALIGN=TOP><I>Comment </I></TD><TD>either 'all' or 'list'</TD></TR>
<TR><TD VALIGN=TOP><I>Type </I></TD><TD>string</TD></TR><TR><TD VALIGN=TOP><I>Default </I></TD><TD>all</TD></TR></TABLE></P>
<BR>
<P><B><TT>measurements
</TT></B><TABLE><TR><TD VALIGN=TOP><I>Comment </I></TD><TD>used when 'select'='list'</TD></TR>
<TR><TD VALIGN=TOP><I>Type </I></TD><TD>measurement_list</TD></TR><TR><TD VALIGN=TOP><I>Default </I></TD><TD></TD></TR></TABLE></P>
<BR>
<P><B><TT>target_spot_tag
</TT></B><TABLE><TR><TD VALIGN=TOP><I>Comment </I></TD><TD>which Name or Name Attrbiute</TD></TR>
<TR><TD VALIGN=TOP><I>Type </I></TD><TD>string</TD></TR><TR><TD VALIGN=TOP><I>Default </I></TD><TD></TD></TR></TABLE></P>
<BR>
<P><B><TT>target_spot_value
</TT></B><TABLE><TR><TD VALIGN=TOP><I>Comment </I></TD><TD>the value</TD></TR>
<TR><TD VALIGN=TOP><I>Type </I></TD><TD>string</TD></TR><TR><TD VALIGN=TOP><I>Default </I></TD><TD></TD></TR></TABLE></P>
<BR>
<P><B><TT>n_spots
</TT></B><TABLE><TR><TD VALIGN=TOP><I>Comment </I></TD><TD>how many nearest matches</TD></TR>
<TR><TD VALIGN=TOP><I>Type </I></TD><TD>integer</TD></TR><TR><TD VALIGN=TOP><I>Default </I></TD><TD>10</TD></TR></TABLE></P>
<BR>
<P><B><TT>metric
</TT></B><TABLE><TR><TD VALIGN=TOP><I>Comment </I></TD><TD>one of 'distance', 'slope' or 'direction'</TD></TR>
<TR><TD VALIGN=TOP><I>Type </I></TD><TD>string</TD></TR><TR><TD VALIGN=TOP><I>Default </I></TD><TD>distance</TD></TR></TABLE></P>
</TABLE></TD></TR><BR><P><LI><B><TT>stop</TT></B><BR></UL></P>


<P>&nbsp</P>

</BODY>
</HTML>
